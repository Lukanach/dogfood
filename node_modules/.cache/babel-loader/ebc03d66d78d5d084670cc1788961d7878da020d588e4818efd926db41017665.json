{"ast":null,"code":"var _jsxFileName = \"/home/il/\\u0414\\u043E\\u043A\\u0443\\u043C\\u0435\\u043D\\u0442\\u044B/Sberuni/dogfood2/src/Pages/SingInPage/SignIn.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport { Formik, Form, Field, ErrorMessage } from 'formik';\nimport { useNavigate } from 'react-router-dom';\nimport { useMutation } from '@tanstack/react-query';\nimport { useDispatch } from 'react-redux';\nimport React from 'react';\nimport { validatorSignIn } from './validatorSignIn';\nimport signInStyles from './signInStyles.module.css';\nimport { dogFoodApi } from '../../Api/DogFoodApi';\nimport { setNewUser } from '../../redux/slices/userSlice';\nimport { REDUX_CART_LS_KEY } from '../../redux/constants';\nimport { cartInitialize } from '../../redux/slices/cartSlice';\nimport { withQuery } from '../../components/HOCs/withQuery';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction SigninInner(_ref) {\n  _s();\n  let {\n    mutateAsync\n  } = _ref;\n  const navigate = useNavigate();\n  const submitHandler = async values => {\n    await mutateAsync(values);\n    setTimeout(() => navigate('/products'));\n  };\n  return /*#__PURE__*/_jsxDEV(Formik, {\n    initialValues: {\n      email: '',\n      password: ''\n    },\n    validationSchema: validatorSignIn,\n    onSubmit: submitHandler,\n    children: formik => {\n      const {\n        isValid\n      } = formik;\n      return /*#__PURE__*/_jsxDEV(Form, {\n        className: signInStyles.form,\n        children: [/*#__PURE__*/_jsxDEV(Field, {\n          name: \"email\",\n          placeholder: \"Email here\",\n          type: \"email\",\n          className: signInStyles.input\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 35,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(ErrorMessage, {\n          name: \"email\",\n          component: \"p\",\n          className: signInStyles.error\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 41,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Field, {\n          name: \"password\",\n          placeholder: \"Password here\",\n          type: \"password\",\n          className: signInStyles.input\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 42,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(ErrorMessage, {\n          name: \"password\",\n          component: \"p\",\n          className: signInStyles.error\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 48,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          disabled: !isValid,\n          type: \"submit\",\n          className: signInStyles.btn,\n          children: \"\\u0412\\u043E\\u0439\\u0442\\u0438\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 49,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 34,\n        columnNumber: 11\n      }, this);\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 23,\n    columnNumber: 5\n  }, this);\n}\n_s(SigninInner, \"CzcTeTziyjMsSrAVmHuCCb6+Bfg=\", false, function () {\n  return [useNavigate];\n});\n_c = SigninInner;\nconst SigninWithQuery = withQuery(SigninInner);\n_c2 = SigninWithQuery;\nfunction Signin() {\n  _s2();\n  console.log('render signin');\n  const dispatch = useDispatch();\n  const {\n    mutateAsync,\n    isError,\n    error,\n    isLoading\n  } = useMutation({\n    mutationFn: values => dogFoodApi.signIn(values).then(user => {\n      const cartFormLS = window.localStorage.getItem(REDUX_CART_LS_KEY);\n      if (cartFormLS) {\n        const cartForCurrentUser = JSON.parse(cartFormLS)[user.data._id];\n        dispatch(cartInitialize(cartForCurrentUser !== null && cartForCurrentUser !== void 0 ? cartForCurrentUser : []));\n      }\n      dispatch(setNewUser(user.data._id, user.token, user.data.email));\n    })\n  });\n  return /*#__PURE__*/_jsxDEV(SigninWithQuery, {\n    mutateAsync: mutateAsync,\n    isError: isError,\n    error: error,\n    isLoading: isLoading\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 83,\n    columnNumber: 5\n  }, this);\n}\n_s2(Signin, \"oM7Jdcf6S/MrWDJ48qKXGeyAU6w=\", false, function () {\n  return [useDispatch, useMutation];\n});\n_c3 = Signin;\nexport const SignInMemo = /*#__PURE__*/React.memo(Signin);\n_c4 = SignInMemo;\nvar _c, _c2, _c3, _c4;\n$RefreshReg$(_c, \"SigninInner\");\n$RefreshReg$(_c2, \"SigninWithQuery\");\n$RefreshReg$(_c3, \"Signin\");\n$RefreshReg$(_c4, \"SignInMemo\");","map":{"version":3,"names":["Formik","Form","Field","ErrorMessage","useNavigate","useMutation","useDispatch","React","validatorSignIn","signInStyles","dogFoodApi","setNewUser","REDUX_CART_LS_KEY","cartInitialize","withQuery","SigninInner","mutateAsync","navigate","submitHandler","values","setTimeout","email","password","formik","isValid","form","input","error","btn","SigninWithQuery","Signin","console","log","dispatch","isError","isLoading","mutationFn","signIn","then","user","cartFormLS","window","localStorage","getItem","cartForCurrentUser","JSON","parse","data","_id","token","SignInMemo","memo"],"sources":["/home/il/Документы/Sberuni/dogfood2/src/Pages/SingInPage/SignIn.jsx"],"sourcesContent":["import {\n  Formik, Form, Field, ErrorMessage,\n} from 'formik'\nimport { useNavigate } from 'react-router-dom'\nimport { useMutation } from '@tanstack/react-query'\nimport { useDispatch } from 'react-redux'\nimport React from 'react'\nimport { validatorSignIn } from './validatorSignIn'\nimport signInStyles from './signInStyles.module.css'\nimport { dogFoodApi } from '../../Api/DogFoodApi'\nimport { setNewUser } from '../../redux/slices/userSlice'\nimport { REDUX_CART_LS_KEY } from '../../redux/constants'\nimport { cartInitialize } from '../../redux/slices/cartSlice'\nimport { withQuery } from '../../components/HOCs/withQuery'\n\nfunction SigninInner({ mutateAsync }) {\n  const navigate = useNavigate()\n  const submitHandler = async (values) => {\n    await mutateAsync(values)\n    setTimeout(() => navigate('/products'))\n  }\n  return (\n    <Formik\n      initialValues={{\n        email: '',\n        password: '',\n      }}\n      validationSchema={validatorSignIn}\n      onSubmit={submitHandler}\n    >\n      {(formik) => {\n        const { isValid } = formik\n        return (\n          <Form className={signInStyles.form}>\n            <Field\n              name=\"email\"\n              placeholder=\"Email here\"\n              type=\"email\"\n              className={signInStyles.input}\n            />\n            <ErrorMessage name=\"email\" component=\"p\" className={signInStyles.error} />\n            <Field\n              name=\"password\"\n              placeholder=\"Password here\"\n              type=\"password\"\n              className={signInStyles.input}\n            />\n            <ErrorMessage name=\"password\" component=\"p\" className={signInStyles.error} />\n            <button\n              disabled={!isValid}\n              type=\"submit\"\n              className={signInStyles.btn}\n            >\n              Войти\n\n            </button>\n          </Form>\n        )\n      }}\n    </Formik>\n  )\n}\nconst SigninWithQuery = withQuery(SigninInner)\n\nfunction Signin() {\n  console.log('render signin')\n  const dispatch = useDispatch()\n  const {\n    mutateAsync, isError, error, isLoading,\n  } = useMutation({\n    mutationFn: (values) => dogFoodApi.signIn(values)\n      .then((user) => {\n        const cartFormLS = window.localStorage.getItem(REDUX_CART_LS_KEY)\n        if (cartFormLS) {\n          const cartForCurrentUser = JSON.parse(cartFormLS)[user.data._id]\n          dispatch(cartInitialize(cartForCurrentUser ?? []))\n        }\n        dispatch(setNewUser(user.data._id, user.token, user.data.email))\n      }),\n  })\n\n  return (\n    <SigninWithQuery\n      mutateAsync={mutateAsync}\n      isError={isError}\n      error={error}\n      isLoading={isLoading}\n    />\n\n  )\n}\nexport const SignInMemo = React.memo(Signin)\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}